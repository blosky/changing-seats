
<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Changing seats</title>
	<meta charset="utf-8">

	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="js/ActiveMap.js"></script>
	<script src="//interactive.guim.co.uk/libs/iframe-messenger/iframeMessenger.js"></script>



	<style type="text/css">

		@font-face{font-family:"Guardian Text Egyptian Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Regular.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Regular.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Regular.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Regular.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Regular.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Regular.svg#GuardianTextEgyptianWeb-Regular") format("svg");font-weight:400;font-style:normal;font-stretch:normal}@font-face{font-family:"Guardian Text Egyptian Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-RegularItalic.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-RegularItalic.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-RegularItalic.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-RegularItalic.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-RegularItalic.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-RegularItalic.svg#GuardianTextEgyptianWeb-RegularItalic") format("svg");font-weight:400;font-style:italic;font-stretch:normal}@font-face{font-family:"Guardian Text Egyptian Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Medium.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Medium.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Medium.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Medium.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Medium.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextEgyptianWeb/GuardianTextEgyptianWeb-Medium.svg#GuardianTextEgyptianWeb-Medium") format("svg");font-weight:700;font-style:normal;font-stretch:normal}@font-face{font-family:"Guardian Egyptian Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Light.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Light.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Light.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Light.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Light.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Light.svg#GuardianEgyptianWeb-Light") format("svg");font-weight:200;font-style:normal;font-stretch:normal}@font-face{font-family:"Guardian Egyptian Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Regular.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Regular.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Regular.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Regular.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Regular.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Regular.svg#GuardianEgyptianWeb-Regular") format("svg");font-weight:400;font-style:normal;font-stretch:normal}@font-face{font-family:"Guardian Egyptian Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Medium.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Medium.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Medium.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Medium.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Medium.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Medium.svg#GuardianEgyptianWeb-Medium") format("svg");font-weight:500;font-style:normal;font-stretch:normal}@font-face{font-family:"Guardian Egyptian Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Semibold.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Semibold.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Semibold.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Semibold.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Semibold.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianEgyptianWeb/GuardianEgyptianWeb-Semibold.svg#GuardianEgyptianWeb-Semibold") format("svg");font-weight:900;font-style:normal;font-stretch:normal}@font-face{font-family:"Guardian Text Sans Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Regular.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Regular.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Regular.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Regular.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Regular.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Regular.svg#GuardianTextSansWeb-Regular") format("svg");font-weight:400;font-style:normal;font-stretch:normal}@font-face{font-family:"Guardian Text Sans Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-RegularItalic.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-RegularItalic.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-RegularItalic.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-RegularItalic.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-RegularItalic.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-RegularItalic.svg#GuardianTextSansWeb-RegularItalic") format("svg");font-weight:400;font-style:italic;font-stretch:normal}@font-face{font-family:"Guardian Text Sans Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Medium.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Medium.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Medium.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Medium.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Medium.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianTextSansWeb/GuardianTextSansWeb-Medium.svg#GuardianTextSansWeb-Medium") format("svg");font-weight:700;font-style:normal;font-stretch:normal}@font-face{font-family:"Guardian Sans Web";src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianSansWeb/GuardianSansWeb-Regular.eot");src:url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianSansWeb/GuardianSansWeb-Regular.eot?#iefix") format("embedded-opentype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianSansWeb/GuardianSansWeb-Regular.woff2") format("woff2"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianSansWeb/GuardianSansWeb-Regular.woff") format("woff"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianSansWeb/GuardianSansWeb-Regular.ttf") format("truetype"),url("//pasteup.guim.co.uk/fonts/0.1.0/hinting-on/kerning-on/original/GuardianSansWeb/GuardianSansWeb-Regular.svg#GuardianSansWeb-Regular") format("svg");font-weight:400;font-style:normal;font-stretch:normal}


		body{margin: 0; padding: 0; max-width:1028px;}
		#container{width: 100%; position:relative; float:left;display: block;}
		.module{width: 100%; margin:0 0 25px 0; position: relative; float: left; border-bottom: 1px solid #dcdcdc;}
		#con_container{border-bottom: none;}
		.text_content{width:44%; position:relative; float:left; }
		ul{position: relative; float: left; padding: 0; margin: 0;  width: 100%;}
		li{ display: inline; float:left; position: relative;}
		/*.constituency_list li{height:50px;}*/
		.constituency_list{margin: 1em 0 1.5em 0; position: relative; float: left;}
		.constituency{margin: 0 1px 5px 0}
		.constituency a{
			  
			  color: #767676;
			  font-family: "Guardian Text Sans Web","Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;
			  font-size: 12px;
			  vertical-align: top;
			  text-decoration: none;
			  
			  border-bottom: 1px dotted grey;
			  cursor: pointer;
			  margin: 0 5px 0 0px;
		}

		.selected a
		{
			border-bottom: 2px solid black;

		}
		/*.party_key{position: relative; float: left; width: 44%;margin-bottom:18px;}
		.party_key div{float: left; position: relative;width: 8px; margin-right: 3em;}*/
		
		.keycolor
		{
			width: 10px;
			  height: 18px;
			  margin-right: 5px;
			  border-radius: 2px;
			  display: inline-block;
			  vertical-align: top;
		}


		.lib{background-color: #FFB900}
		.alliance{background-color: #B3B3B4}
		.pc{background-color: #868686}
		.sdlp{background-color: #99FF66}
		.sf{background-color: #7eaa58}
		.snp{background-color: #FCDD03}
		.ukip{background-color: #7D0069}
		.uup{background-color: #99FF66}
		.dup{background-color: #99002e}
		.green{background-color: #33A22B}



		h1 {
			line-height: 1.2;
			  font-family: "Guardian Egyptian Web",Georgia,serif;
			  font-size: 22px;
			  font-weight: bold;
			  padding-top: 5px;
		}

		.f-standfirst {
			font-family: "Guardian Text Egyptian Web",Georgia,serif;
			font-size: 18px;
			color: #767676;
		}

		svg {max-width-height:100%;}

		#lab_map, #con_map{width: 48%; position: relative;float: right;}

		#map{width: 100%;}

		#tooltip{z-index:1000;position: absolute; background-color: white;   width: 200px;
				  padding: 5px;
				  margin-left: 25px;
				  background: rgba(255,255,255,0.9);
				  border: 1px solid #ddd;
				}

		#tooltip b {
		  font-family: "Guardian Sans Web","Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;
		  font-weight: 800;
		  font-size: 13px;
		  margin: 0 2px 0 0;
		  padding: 0;
		  color: #000;
		}

		#tooltip p {
		  font-family: "Guardian Text Sans Web","Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;
		  font-size: 12px;
		  color: #767676;
		  float: left;
		  margin: 0 2px 0 0;
		  line-height:1.3em;
		}

		.inactive{display: none;}

		#mobile_container{position: relative; float: left; display: none;}

		
		svg path.selected {
			  stroke: #333333;
			  stroke-width: 2px;
			  fill: none;
		}


		@media screen and (max-width: 620px){

			#map{display: none}
			.text_content{width:100%;}

			.constituency{margin-bottom:1px;}
			.constituency a{
			 
			  border-bottom: none;
			  cursor: inherit;

			}
		}
	</style>

</head>
<body>
	<div id="container">
		<div id="lab_container" class='module'>
			<h1>If you want Ed Miliband to be the prime minister ... </h1>
			<div class='text_content'>

				<div id="party_key1" class="party_key">
					<div id="lib">
						<ul>
							<li class="f-standfirst">
								<span class="keycolor lib"></span>
								Vote for the Lib Dems in these constituencies:
							</li>
						</ul>
					</div>
					<div id='lib_list' class='constituency_list'>
						<ul>
						</ul>
					</div>
				</div>
				<div id="party_key2" class="party_key">
					<div id="ukip">
						<ul>
							<li class="f-standfirst">
								<span class="keycolor ukip"></span>
								Vote for Ukip in these constituencies:
							</li>
						</ul>
					</div>
					<div id='ukip_list' class='constituency_list'>
						<ul>
						</ul>
					</div>
				</div>
				<div id="party_key3" class="party_key">
					<div id="pc">
						<ul>
							<li class="f-standfirst">
								<span class="keycolor pc"></span>
								Vote for PC in these constituencies:
							</li>
						</ul>
					</div>
					<div id='pc_list' class='constituency_list'>
						<ul>
						</ul>
					</div>
				</div>
				<div id="party_key4" class="party_key">
					<div id="snp">
						<ul>
							<li class="f-standfirst">
								<span class="keycolor snp"></span>
								Vote for SNP in these constituencies:
							</li>
						</ul>
					</div>
					<div id='snp_list' class='constituency_list'>
						<ul>
						</ul>
					</div>
				</div>
				<div id="party_key5" class="party_key">
					<div id="green">
						<ul>
							<li class="f-standfirst">
								<span class="keycolor green"></span>
								Vote for Green in these constituencies:
							</li>
						</ul>
					</div>
					<div id='green_list' class='constituency_list'>
						<ul>
						</ul>
					</div>
				</div>
			</div>
			
			<div id='lab_map'>
				<div id='map'></div>
			</div>
		</div>



		<div id="con_container" class='module'>
			<h1>If you want tories to win...</h1>
			<div class='text_content'>

				<div id="party_key1" class="party_key">
					<div id="lib">
						<ul>
							<li class="f-standfirst">
								<span class="keycolor lib"></span>
								Vote for LibDem in these constituencies:
							</li>
						</ul>
					</div>
					<div id='lib_list' class='constituency_list'>
						<ul>
						</ul>
					</div>
				</div>
				<div id="party_key2" class="party_key">
					<div id="ukip">
						<ul>
							<li class="f-standfirst">
								<span class="keycolor ukip"></span>
								Vote for Ukip in these constituencies:
							</li>
						</ul>
					</div>
					<div id='ukip_list' class='constituency_list'>
						<ul>
						</ul>
					</div>
				</div>
			</div>

			<div id='con_map'>
				<div id='map'></div>
			</div>
		</div>
		

		<div id='tooltip' class='inactive'></div>
		

		
	</div>

	<div id="mobile_container">
		hola que tal
	</div>


	<script type="text/javascript">



		var data; // a global
		var datum=[];
		var parties =[];
		var map_labour;
		var map_conservative;

		var mapLeft = document.getElementById('lab_map').offsetLeft;
		var mapWidth = document.getElementById('map').offsetWidth;
		var mapLabTop = document.getElementById('lab_map').offsetTop;
		var mapConTop = document.getElementById('con_map').offsetTop;
		

		
		d3.json("http://interactive.guim.co.uk/spreadsheetdata/1n5p8pJXNcPW4M3q_CackOhKJveSSVUIzSm_qloHOmrQ.json", function(error, json)
		{
			if (error) return console.warn(error);
			data = json;
			data.sheets.Sheet1.forEach(function(d,i)
				{
					parties.push(d.tacticalvote);

					datum[data.sheets.Sheet1[i].proid] =
					{
						margin:data.sheets.Sheet1[i].margin,
						margin_2:data.sheets.Sheet1[i].margin_2,
						name:data.sheets.Sheet1[i].name,
						proid:data.sheets.Sheet1[i].proid,
						projection:data.sheets.Sheet1[i].projection,
						rowNumber:data.sheets.Sheet1[i].rowNumber,
						scenario:data.sheets.Sheet1[i].scenario,
						second:data.sheets.Sheet1[i].second,
						tacticalvote:data.sheets.Sheet1[i].tacticalvote,
						tacticalvoteText:data.sheets.Sheet1[i].tacticalvotetext
					}


					if(d.scenario == 'lab')
					{
						d3.select("#lab_container #" + d.tacticalvote + "_list ul")
						.append("li")
						.attr("class", "constituency")
						.attr("id", d.proid)
						.on('click', labClicked)
						.append("a")
						.attr("id", d.proid)
						.html(d.name + ', ')
					}

					else
					{
						d3.select("#con_container #" + d.tacticalvote + "_list ul")
						.append("li")
						.attr("class", "constituency")
						.attr("id", d.proid)
						.on('click', conClicked)
						.append("a")
						.html(d.name + ', ');
					}
					
				});
			
		});

		function labClicked(event)
		{
			var path = d3.selectAll('#lab_map #map #lab #' + this.id ).attr("d");



				map_labour.setClone(path);

				d3.selectAll('.constituency_list .constituency').attr('class', 'constituency');
				d3.select(this).attr('class', 'constituency selected');
			}
			

		function conClicked(event)
			{
				var path = d3.select('#con_map #map #con #' + this.id ).attr("d");

				map_conservative.setClone(path);

				d3.selectAll('.constituency_list .constituency').attr('class', 'constituency');

				
				d3.select(this).attr('class', 'constituency selected');
			}
		



		map_labour=new ActiveMap("lab_con.svg",{
			container:"#lab_map #map",
			active:["#lab"],
			inactive:["#con"],	
			callback:function(constituency,coords){

				console.log(String(datum[constituency.id].tacticalvoteText).substr(0,2));

				d3.select('#tooltip').classed("inactive", false)

				//d3.selectAll(".selected").classed("selected",false)
				d3.selectAll("#lab_container .constituency" ).classed("selected", false);
				d3.select("#lab_container #" + constituency.id).classed("selected", true);

				constituency.paths.forEach(function(p){


					var path = map_labour.getSVG().select("#"+p).attr("d")


					map_labour.setClone(path);

					d3.select('#tooltip')
					.html(
						'<p>In <b>' + datum[constituency.id].name + '</b> if you want <b>Ed Miliband</b> to be prime minister, you should consider a tactical vote for <b>' + datum[constituency.id].tacticalvoteText + '</b></p>'
						)
					.style('top',  coords[1] - 25 + 'px')
					.style('left', function(){if(mapLeft + coords[0] + document.getElementById('tooltip').offsetWidth > mapLeft + mapWidth)return mapLeft + mapWidth - document.getElementById('tooltip').offsetWidth -50 + 'px'; else return mapLeft + coords[0] + 'px'});

				});
			},
			callbackOut:function(constituency){

					d3.select('#tooltip').classed("inactive", true);
			}
		})

		map_conservative=new ActiveMap("lab_con.svg",{
			container:"#con_map #map",
			active:["#con"],
			inactive:["#lab"],
			callback:function(constituency,coords){

				d3.select('#tooltip').classed("inactive", false)

				//d3.selectAll(".selected").classed("selected",false)
				d3.selectAll("#con_container .constituency" ).classed("selected", false);
				d3.select("#con_container #" + constituency.id).classed("selected", true);

				constituency.paths.forEach(function(p){


					var path = map_conservative.getSVG().select("#"+p).attr("d")


					map_conservative.setClone(path);

					d3.select('#tooltip')
					.html(
						'<p>In <b>' + datum[constituency.id].name + '</b> if you want <b>David Cameron</b> to be prime minister, you should consider a tactical vote for <b>' + datum[constituency.id].tacticalvoteText + '</b></p>'
						)
					.style('top',  document.getElementById('con_container').offsetTop + coords[1] - 25 + 'px')
					.style('left', function(){if(mapLeft + coords[0] + document.getElementById('tooltip').offsetWidth > mapLeft + mapWidth)return mapLeft + mapWidth - document.getElementById('tooltip').offsetWidth -50 + 'px'; else return mapLeft + coords[0] + 'px'});

				});
			},
			callbackOut:function(constituency){

					d3.select('#tooltip').classed("inactive", true);
			}
		})

		d3.selection.prototype.moveToFront = function() {
		  return this.each(function(){
		    this.parentNode.appendChild(this);
		  });
		};

		/*http://interactive.guim.co.uk/spreadsheetdata/1n5p8pJXNcPW4M3q_CackOhKJveSSVUIzSm_qloHOmrQ.json*/

	</script>
	<script>
    iframeMessenger.enableAutoResize();
	</script>
</body>
</html>

